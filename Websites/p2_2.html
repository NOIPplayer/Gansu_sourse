<!DOCTYPE html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
	<meta name="description" content=""/>
	<meta name="keywords" content="" />
	<meta name="author" content="" />
	<link rel="stylesheet" type="text/css" href="style.css" media="screen" />
	<meta charset="utf-8">
    <title>甘肃能源消费数据剖析</title>
    <script src="https://cdn.staticfile.net/echarts/4.3.0/echarts.min.js"></script>
</head>

<body id="top">

<div id="header-wrapper">
	<div id="header-wrapper-2">
		<div class="center-wrapper">

			<div id="header">

				<div id="lzu_logo"></div>
				<div id="logo">
					<h1 id="site-title"><a href="index.html">甘肃能源消费数据剖析</a></h1>
					<h2 id="site-slogan">小组成员：李有龙、范圣如、李阳泽（排名不分先后）</h2>
					<h2 id="site-slogan">指导老师：赵志立</h2>
				</div>

				<div id="help-wrapper">
					<div id="help">

						<a href="contact_us.html">联系我们</a> <span class="text-separator">|</span>
						 <a href="https://github.com/NOIPplayer/Gansu_sourse">访问 Github 项目</a> <span class="text-separator">

					</div>
				</div>

			</div>

		</div>
	</div>
</div>

<div id="navigation-wrapper">
	<div id="navigation-wrapper-2">
		<div class="center-wrapper">

			<div id="navigation">

				<ul class="tabbed">
					<li><a href="index.html">主页</a></li>
					<li><a href="p1_1.html">能源消费量总览</a></li>
					<li class="current_page_item"><a href="p2_1.html">行业能源消费量</a></li>
					<li><a href="p3_1.html">生活能源消费量</a></li>
					<li><a href="https://tjj.gansu.gov.cn/tjj/c109464/info_disp.shtml">数据来源</a></li>
				</ul>

				<div class="clearer">&nbsp;</div>

			</div>

		</div>
	</div>
</div>

<div class="bc">
    
    <div id="sidebar-wrapper2">
        <div id="sidebar">

            <div class="box">

                <div class="box-title">切换视图</div>

                <div class="box-content">
                    <ul class="nice-list">
                        <li><a href="p2_1.html">综合能源</a></li>
                        <li><a href="p2_2.html">石油</a></li>
                        <li><a href="p2_3.html">煤炭</a></li>
                        <li><a href="p2_4.html">电力</a></li>
                    </ul>
                </div>

            </div>

            <div class="box">

                <div class="box-title">下载数据</div>

                <div class="box-content">
                    <ul class="nice-list">
                        <li><a href="data/GSsourse/3.xls">数据表1</a></li>
                        <li><a href="data/GSsourse/4.xls">数据表2</a></li>
                        <li><a href="data/GSsourse/5.xls">数据表3</a></li>
                        <li><a href="data/GSsourse/6.xls">数据表4</a></li>
                    </ul>
                </div>

            </div>
        </div>
    </div>

    <div id="treemapChart" class="p2_2"></div>
    <div id="lineChart" class="p2_1"></div>
    <div class="p2_2_text-container_1">
        <p>近十年来，在石油消费量中，甘肃省各大行业的消费量并无明显上升或者下降趋势，整体呈现波动或平稳走向。在各行业中，工业和交通运输、仓储和邮政业的对石油的需求量最大，占石油消费量的80%左右，但其石油消耗量波动极大，对石油市场的行情变化有着极高的敏感度，这一定程度上制约了对石油这一能源的利用。</p>
    </div>
    <div class="clearer">&nbsp;</div>
</div>

<script type="text/javascript">
    var lineChart = echarts.init(document.getElementById('lineChart'));
    var treemapChart = echarts.init(document.getElementById('treemapChart'));

    var datasetSource = [
        ['各行业的能源消费量', '2014', '2015', '2016', '2017', '2018', '2019', '2020', '2021', '2022', '2023'],
        ['农、林、牧、渔业', '37', '37', '41', '41.3', '38.8', '38.5', '39.5', '35.75', '37.14', '39.4'] ,
        ['工业', '391.72', '397.8569', '373.54', '390.22', '396.03', '348.76', '373.53', '386.06', '477.13', '427.82'] ,
        ['建筑业', '32.4', '34.5', '39', '39.5', '35.95', '36.65', '37.42', '36.5', '36.96', '46.92'] ,
        ['交通运输、仓储和邮政业', '303.88', '257.65', '260.89', '264.3', '255.3', '254.14', '247.6', '231.08', '253.52', '286.33'] ,
        ['批发、零售业和住宿、餐饮业', '12.36', '14.16', '18.02', '18.22', '19.3', '18.9', '19.11', '19.79', '17.6', '21.65'] ,
        ['其他', '50.7', '49.5', '67', '67', '63.5', '65.47', '64.97', '66.87', '64.95', '75.14']
    ];

    var lineOption = {
        tooltip: {
            trigger: 'axis',
            showContent: true
        },
        title: {
            text: '2014-2023年各行业石油消费量变化折线图',
            left: 'center',
            top: '10px'
        },
        legend: {
            orient: 'horizontal', 
            left: 'center',  
            top: '50px',  
            padding: [5, 10, 5, 10], 
            itemGap: 15,          
            itemWidth: 20,        
            itemHeight: 10       
        },
        grid: {
            left: '6%',
            right: '6%',
            top: '120px',   
            bottom: '5%',
            containLabel: true
        },
        dataset: {
            source: datasetSource
        },
        nameTextStyle: {
            fontSize: 14
        },
        xAxis: { name: '年份', axisLabel: { fontSize: 14 }, type: 'category' },
        yAxis: { name: '消费量（单位：万吨）', axisLabel: { fontSize: 14 } },
        series: [
            { type: 'line', smooth: true, seriesLayoutBy: 'row', dataIndex: 0, name: '农、林、牧、渔业', itemStyle: { color: '#e57373' }, lineStyle: { width: 3 }, symbolSize: 5},
            { type: 'line', smooth: true, seriesLayoutBy: 'row', dataIndex: 1, name: '工业', itemStyle: { color: '#ff9f40' }, lineStyle: { width: 3 }, symbolSize: 5},
            { type: 'line', smooth: true, seriesLayoutBy: 'row', dataIndex: 2, name: '建筑业', itemStyle: { color: '#36a2eb' }, lineStyle: { width: 3 }, symbolSize: 5},
            { type: 'line', smooth: true, seriesLayoutBy: 'row', dataIndex: 3, name: '交通运输、仓储和邮政业', itemStyle: { color: '#ff6384' }, lineStyle: { width: 3 }, symbolSize: 5},
            { type: 'line', smooth: true, seriesLayoutBy: 'row', dataIndex: 4, name: '批发、零售业', itemStyle: { color: '#9575cd' }, lineStyle: { width: 3 }, symbolSize: 5},
            { type: 'line', smooth: true, seriesLayoutBy: 'row', dataIndex: 5, name: '其他', itemStyle: { color: '#4bc0c0' }, lineStyle: { width: 3 }, symbolSize: 5}
        ]
    };

    //计算特定年份的总值的函数，因为树图无法直接使用{d}
    function calculateTotalValue(yearIndex) {
        var totalValue = 0;
        for (var i = 1; i < datasetSource.length; i++) {
            totalValue += parseFloat(datasetSource[i][yearIndex]);
        }
        return totalValue;
    }

    //更新树图数据
    function updateTreemap(yearIndex) {
        var totalValue = calculateTotalValue(yearIndex);
        var updatedData = [
            {name: '农、林、牧、渔业', value: parseFloat(datasetSource[1][yearIndex]), itemStyle: {color: '#e57373'}, label: {show: true, formatter: function(params) { return params.name + ':\n' + ((params.value / totalValue) * 100).toFixed(2) + '%'; }}},
            {name: '工业', value: parseFloat(datasetSource[2][yearIndex]), itemStyle: {color: '#ff9f40'}, label: {show: true, formatter: function(params) { return params.name + ':\n' + ((params.value / totalValue) * 100).toFixed(2) + '%'; }}},
            {name: '建筑业', value: parseFloat(datasetSource[3][yearIndex]), itemStyle: {color: '#36a2eb'}, label: {show: true, formatter: function(params) { return params.name + ':\n' + ((params.value / totalValue) * 100).toFixed(2) + '%'; }}},
            {name: '交通运输、仓储和邮政业', value: parseFloat(datasetSource[4][yearIndex]), itemStyle: {color: '#ff6384'}, label: {show: true, formatter: function(params) { return params.name + ':\n' + ((params.value / totalValue) * 100).toFixed(2) + '%'; }}},
            {name: '批发、零售业', value: parseFloat(datasetSource[5][yearIndex]), itemStyle: {color: '#9575cd'}, label: {show: true, formatter: function(params) { return params.name + ':\n' + ((params.value / totalValue) * 100).toFixed(2) + '%'; }}},
            {name: '其他', value: parseFloat(datasetSource[6][yearIndex]), itemStyle: {color: '#4bc0c0'}, label: {show: true, formatter: function(params) { return params.name + ':\n' + ((params.value / totalValue) * 100).toFixed(2) + '%'; }}}
        ];

        treemapChart.setOption({
            title: {
                text: datasetSource[0][yearIndex] + '各行业石油消费量占比树图', //动态设置树图的标题，让他随鼠标悬停位置变化
                left: 'center',
                top: '10px'
            },
            grid: {
                left: '5%',
                right: '5%',
                top: '120px',            
                bottom: '20%',
                containLabel: true
            },
            series: [{
                data: updatedData
            }]
        });
    }

    lineChart.on('updateAxisPointer', function (event) {
        var xAxisInfo = event.axesInfo[0];
        if (xAxisInfo) {
            var yearIndex = xAxisInfo.value + 1;
            updateTreemap(yearIndex);
        }
    });

    lineChart.setOption(lineOption);
    treemapChart.setOption({
        title: {
            text: '2014各行业石油消费量占比树图',
            left: 'center',
            top: '10px'
        },
        grid: {
            left: '5%',
            right: '5%',
            top: '120px',            
            bottom: '20%',
            containLabel: true
        },
        series: [{
            type: 'treemap',
            id: 'treemap',
            layout: 'realistic',
            leafDepth: 1,
            visualDimension: 0,
            data: [
                {name: '农、林、牧、渔业', value: 37, itemStyle: {color: '#e57373'}, label: {show: true, formatter: function(params) { return params.name + ':\n' + ((params.value / 828.06) * 100).toFixed(2) + '%'; }}},
                {name: '工业', value: 391.72, itemStyle: {color: '#ff9f40'}, label: {show: true, formatter: function(params) { return params.name + ':\n' + ((params.value / 828.06) * 100).toFixed(2) + '%'; }}},
                {name: '建筑业', value: 32.4, itemStyle: {color: '#36a2eb'}, label: {show: true, formatter: function(params) { return params.name + ':\n' + ((params.value / 828.06) * 100).toFixed(2) + '%'; }}},
                {name: '交通运输、仓储和邮政业', value: 303.88, itemStyle: {color: '#ff6384'}, label: {show: true, formatter: function(params) { return params.name + ':\n' + ((params.value / 828.06) * 100).toFixed(2) + '%'; }}},
                {name: '批发、零售业', value: 12.36, itemStyle: {color: '#9575cd'}, label: {show: true, formatter: function(params) { return params.name + ':\n' + ((params.value / 828.06) * 100).toFixed(2) + '%'; }}},
                {name: '其他', value: 50.7, itemStyle: {color: '#4bc0c0'}, label: {show: true, formatter: function(params) { return params.name + ':\n' + ((params.value / 828.06) * 100).toFixed(2) + '%'; }}}
            ]
        }]
    });
</script>

<div id="footer-wrapper">

	<div class="center-wrapper">

		<div id="footer">

			<div class="left">
				<a href="index.html">主页</a> <span class="text-separator">|</span> 
                <a href="p1_1.html">能源消费量总览</a> <span class="text-separator">|</span>
                <a href="p2_1.html">行业能源消费量</a> <span class="text-separator">|</span> 
                <a href="p3_1.html">生活能源消费量</a> <span class="text-separator">|</span> 
                <a href="https://tjj.gansu.gov.cn/tjj/c109464/info_disp.shtml">数据来源</a> <span class="text-separator">|</span> 
			</div>

			<div class="right">
				<a href="#">到顶 ^</a>
			</div>

			<div class="clearer">&nbsp;</div>

		</div>

	</div>

</div>

<div id="bottom">

	<div class="center-wrapper">

		<div class="left">
			&copy; 2024 甘肃能源消费数据剖析 <span class="text-separator">|</span> <a href="#">Privacy Policy</a> <span class="text-separator">|</span> <a href="#">Terms of Use</a>
		</div>
		<div class="clearer">&nbsp;</div>

	</div>

</div>

</body>
</html>
